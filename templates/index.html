<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Brainstorming App</title>
</head>
<body>
    <h1>Inserisci la tua idea</h1>
    <form id="idea-form">
        <textarea id="idea-input" rows="5" cols="60" placeholder="Scrivi qui la tua idea senza limiti..."></textarea><br>
        <button type="submit">Invia</button>
    </form>

    <h2>Idee condivise</h2>
    <ul id="ideas-list"></ul>

    <script>
        const form = document.getElementById("idea-form");
        const input = document.getElementById("idea-input");
        const list = document.getElementById("ideas-list");

        form.addEventListener("submit", async (e) => {
            e.preventDefault();
            const content = input.value.trim();
            if (content) {
                const res = await fetch("/idea", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ content }),
                });
                const data = await res.json();
                if (data.status === "ok") {
                    input.value = "";
                    loadIdeas();
                } else {
                    alert(data.message);
                }
            }
        });

        async function loadIdeas() {
            const res = await fetch("/ideas");
            const data = await res.json();
            list.innerHTML = "";
            data.ideas.forEach(idea => {
                const li = document.createElement("li");
                li.textContent = idea.content;
                list.appendChild(li);
            });
        }

        loadIdeas();
    </script>
</body>
</html>
